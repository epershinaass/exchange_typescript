# Просмотр списков добавленных товаров в портфель пользователя

Дата: 2022-07-13

## Статус

PROPOSED

## Требование

Пользователь может просматривать свой портфель товаров.

1. Пользователь переходит в свой личный кабинет и нажимает кнопку “Мой портфель”.
2. Система перенаправляет пользователя на форму списка товаров в его портфеле.
3. Пользователь видит несортированный список своих товаров.
4. Система отображает в списке по каждому товару его наименование и количество.

[Ссылка на исходный документ > 2.5](https://docs.google.com/document/d/1HwW4-Q8kIadQPA3vRosXDwSpWbfjIRJMwdgL5OhvnXY/edit#bookmark=id.mp2ty44x9mgp)

## Решение

- Храним товары в виде обьектов в БД.
- Привязать список товаров к пользователю.

Структура обьекта в БД:

```ts
UserProducts {
  user_id:string,
  products:Product[]
}
```
```ts
Product {
  product_id:string,
  name:string,
  quantity:number
}
```

- Запись с пустым списком товаров в БД будет создаваться, в тот момент, когда пользователь зарегистрировался.

+ (+) Простота реализации
+ (-) Дублирование и расхождение данных при их изменении

### Альтернативный вариант хранения

- Храним товары в отдельном микросервисе

```js
product {
  product_id:string,
  quantity:number
}
```
+ (+) Консистентность данных в случае изменения товара
+ (-) Дополнительный запрос для получения товаров


### Формат передачи данных товаров из сервиса

```proto3
service ProductService {
  rpc GetUserProductsList (GetUserProductsListRequest) returns (GetUserProductsListResponse) {}
}

message GetUserProductsListRequest {
  string user_id = 1;
}

message GetUserProductsListResponse {
  repeated Product items = 1;
}

message Product {
    string id = 1;
    string name = 2;
    number quantity = 3;
}
```

### Получение списка товаров

Проверяем не пустой ли массив товаров в БД, если присутствует хоть один объект, то отправляем сообщением список товаров.</br> В случае если массив товаров пуст, то отправить сообщение с описанием ошибки.


## Заключение

При написании ADR руководствовались простотой и понятностью реализации. Оставляя возможность для изменения в реализации при необходимости.
